<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />
<title>Jump from SOAP to REST with WSDL2REST</title>
</head>
<body>
<h1>Jump from SOAP to REST with WSDL2REST</h1>
     -------------------------------------



<h2>1. REST overview</h2>
<p>Representational State Transfer (REST) is an architectural style for distributed hypermedia systems. Refer Roy
Fielding's [1] for detail on the architectural style. REST architectural style has been used to guide the design and
development of the architecture for the modern Web. It defines how resources are defined and addressed.</p>

<p>The core abstraction in REST is a remote resource instead of a remote procedure call.  Rather than inventing an
exhaustive list of standards, REST uses existing Internet standards, including HTTP, XML, and TCP/IP. Instead of every possible
scenario, REST covers the most common problems. </p>

<p>Uses TCP/IP naming standards to name resources on the Web. Queries and manipulates those resources with HTTP.
Uses standard text-based message formats like XML or HTML to structure data</p>

<p>And well-formed HTML is a subset of XML, satisfying the last REST requirement</p>

<p>The most important HTTP methods are POST, GET, PUT and DELETE which CRUD operations should be map to.</p>
<p><br>
POST   - Create, Update, Delete<br>
GET    - Read<br>
PUT    - Create, Update<br>
DELETE - Delete<br>
</p>
Characteristics of the REST
<ul>
<li>Request/Response style
<li>stateless
<li>cache
<li>defined resources
<li>interconnected
<li>multi-layered
</ul>

<p>Consider a service that allows you to get a stock quote with name StockQuoteService, with operation getStockQuote(String
ticker). The web service makes available a URL to each ticker symbols resource. Example, here's how a client requests
stock quote for ticker XYZ</p>

<code>
http://www.stock-example.com/stockquoteservice/StockQuote/XYZ
</code>

<p>client would make a HTTP GET request on this URL which would return following information:</p>
<ul><br>
-Last Price<br>
-Highest trade today<br>
-Lowest trade today<br>
-etc.<br>
</ul>

<p>in a say XML document like:</p>
<code>
&lt;?xml version="1.0"?&gt; <br>
&lt;q:StockQuote xmlns:q="http://www.stock-example.com"<br>
              xmlns:xlink="http://www.w3.org/1999/xlink"&gt;<br>
	&lt;ticker&gt;XYZ&lt;/ticker&gt;                                     <br>
	&lt;last-price currency="USD"&gt;10.32&lt;/last-price&gt;                <br>
	&lt;highest-trade-today&gt; ... &lt;/highest-trade-today&gt;                 <br>
	&lt;lowest-trade-today&gt; ... &lt;/lowest-trade-today&gt;                       <br>
	&lt;bid xlink:href="http://www.stock-example.com/stockbidderservice/bid/XYZ"/&gt;<br>
&lt;/q:StockQuote&gt;                                                                    <br>
</code>

<p>As you could see the retuned XML document has the required infomation plus a additional continuation infomation if the
client expected make a bid for the got infomation. This XML could be mapped to a object in an object oriented language such
as java, c# & C++ ... etc. Sor an example in java this could be mapped through JAXB (java api for xml binding)
i.e. returned class could be some what:</p>

<code>
class StockQuote{<br>
	String ticker;<br>
	String currency;  <br>
	BigDecimal lastPrice; <br>
	BigDecimal highestPriceToday;<br>
	BigDecimal lowestPriceToday;     <br>
	                                     <br>
	URL bid;                                 <br>
	                                             <br>
	....                                             <br>
}                                          <br>
</code>

<p>Main point in REST architecture is that we need giving a resource id for all our entities that need manipulating.
as in above example the resource id is the ticker which combined with the service endpoint forms a URI. Other points are
all calls should be stateless[1]. The resources should be nouns, not verbs.</p>

<p>It is important that GET method should not modify any resources i.e.  free of side effects; this maps to readonly
operations, if write operations are required the HTTP POST, PUT or DELETE should be used.</p>

<p>Now consider a that we need some past stock quotes data for a given period to do some analytics. For example consider a
method StockQuote[] getStockQuoteHistory(String ticker, String fromDate, String toDate); this could be mapped to a URI
like:</p>
<p>(for simplicity for explanation, here the date is given as a string; but we could have used Date object instead)
http://www.stock-example.com/stockquoteservice/StockQuoteHistory/XYZ/&lt;fromdate&gt;/&lt;todate&gt;</p>

<p>e.g. if we want the stock quote from 01/01/2008 to 01/31/2008 then the URI would map to something like this:</p>

<p>http://www.stock-example.com/stockquoteservice/StockQuoteHistory/XYZ/01012008/01312008</p>

<p>This is an implisit URI and is not a physical one. It's our service implementation which interprits meaning of this URI.</p>





<h2>2. Mapping SOAP services to RESTful services  </h2>

<p>The approach here explained a as one solution for the migration. It is request for comments, suggestion etc.</p>

<p>How do we map SOAP method calls & parameters to resources?</p>

<p>REST is basically represents resources and operations on those resources. Where as,
SOAP more or less hides real resource behind exposed service interface. E.g.
A SOAP service method like getArticle(1) could be maps to GET /article/1 of RESTful service. What if an operation like:</p>

setContactDetails(InvokationContext ctx, String firstName, String lastName, String description, String addressLine1,
String addressLine2, String city, String state, String zipcode, String country)

need mapping to REST style.

Here above the InvokationContext is used to send client credentials, context related information etc.
Consider an example of calling above method with following data

setContactAddress(ctx, “John  “ABC Computing Systems Inc,  Suite 5A-1204”,
                                     “Orchard Park“, “TUCSON”, “AZ”, 85705, USA)

When this is mapped to REST style resources we might define URL something like:

http://hostname:port/directory-service/ContactAddress/<name(firstname,lastname)>

to store the data we need to POST the data on the above URI. However, there is couple of problems:

-Based on the above contact address details this URI could grow large; As you know some web servers have limitation on
the URL size.
- what about InvokationContext, may be we could omit it for the time being but, it may also be needed to map, but we
cannot determine the size or the content in it.

One way to reduce the length as this example is to map resources as abstract:
Say since we know it is contact address we only provide person name instead of all address fields ids.

Let’s say now we need obtaining above person’s country of work from the directory service above using HTTP GET. Mmm… how
should we issue the resource request??
Either we should retrieve the full contact address or we should request it through a parameter on the URL query string
which latter is wrong in REST style webservices.
Ideally there should be another URL like this:

http://hostname:port/directory-service/ContactAddress/<name(firstname,lastname)>/country and issuing a GET on this URL
result in the person’s country of work.

ok now lets say this person has moved and now we need to update his current location address. This need issuing UPDATE
(or POST) HTTP requests for the person on the following URL.

http://hostname:port/directory-service/ContactAddress/<name(firstname,lastname)>

Assume that at beginning of this system, directory-service need provisioning/register users on the system. So the HTTP
PUT operation is issued on the URL

http://hostname:port/directory-service/<name(firstname,lastname)>
to provision a particular user on the system by passing user information something like date of birth.

Assume as in above example a SOAP based service has been implemented (see reference sample). If we take the respective
WSDL it has following main components.

<definitions>
<types>
   definition of types........
</types>

<message>
   definition of a message....
</message>

<portType>
   definition of a port.......
</portType>

<binding>
   definition of a binding....
</binding>

</definitions>

- WSDL Ports
The <portType> element is the most important WSDL element.
It describes a web service, the operations that can be performed, and the messages that are involved.
The <portType> element can be compared to a function library (or a module, or a class) in a traditional programming
language.

- WSDL Messages
The <message> element defines the data elements of an operation.
Each message can consist of one or more parts. The parts can be compared to the parameters of a function call in a
traditional programming language.

- WSDL Types
The <types> element defines the data type that are used by the web service.
For maximum platform neutrality, WSDL uses XML Schema syntax to define data types.

- WSDL Bindings
The <binding> element defines the message format and protocol details for each port.



<h3>HTTP Defintion</h3>

<h4>GET</h4>
<p>The GET method means retrieve whatever information (in the form of an entity) is identified by the Request-URI. If the Request-URI refers to a data-producing process, it is the produced data which shall be returned as the entity in the response and not the source text of the process, unless that text happens to be the output of the process. 

The semantics of the GET method change to a "conditional GET" if the request message includes an If-Modified-Since, If-Unmodified-Since, If-Match, If-None-Match, or If-Range header field. A conditional GET method requests that the entity be transferred only under the circumstances described by the conditional header field(s). The conditional GET method is intended to reduce unnecessary network usage by allowing cached entities to be refreshed without requiring multiple requests or transferring data already held by the client.

The semantics of the GET method change to a "partial GET" if the request message includes a Range header field. A partial GET requests that only part of the entity be transferred, as described in Section 14.35 (Range). The partial GET method is intended to reduce unnecessary network usage by allowing partially-retrieved entities to be completed without transferring data already held by the client.

The response to a GET request is cacheable if and only if it meets the requirements for HTTP caching described in Section 13 (Caching in HTTP).

See Section 15.1.3 (Encoding Sensitive Information in URI's) for security considerations when used for forms. </p>




<h2>3. High Level Approach</h2>

High level approach to the solution is outline below:

WSDL -> obtain service API & params etc-> map resources (URLs) & http operations -> user refines mapping -> generate
jsr-311 configuration & classes.

Wsdl2java tool generates java binding for the webservices. It creates java code for services implementation and
respective Java code for client side artifacts. The wsdl2java current impl. has mechanism to read WSDL document and
generate it’s object model and emit respective java code for that. Since this tool has the way of reading, understanding
& creating a respective wsdl representation, we could use it to read the WSDL and create us the representation (in
memory). There is an emitter code which you could plug in to generate output of what you need, from that in memory
representation. This resembles a compiler & a code generator. Compiler part include parser which could parse WSDL
document (including syntax checking etc), and creating the parsed tree in memory which could be used for code
generation. In this case the code generator generates java code. What we could do is replace this code generator to
generate required RESTful services stubs & skeletons implementation java code. This seems feasible. i.e. replace the
java emitter with the emitter to generate RESTful services stubs.

idea is to target this output for an existing REST supporting tool kit like: CXF, Axis etc. for starter.
i.e. we generate services stubs targeting these tool kits until we create one of our own.
The generated code should follow the JSR-311 specification.

Springframework allows us to define & use webservices very simply than creating respective tool kit based stubs. So we
should plan on creating a springframework plug in to make use of our generated classes from the wsdl2REST tool kit. Its
proxy based service definition & invocation model make things easier by not wanting to understand a particular tool kit
implementation.


<<TODO>>

<h2>References</h2>:

[1] Fielding, Roy Thomas. Architectural Styles and the Design of Network-based Software Architectures. Doctoral
dissertation, University of California, Irvine, 2000: http://www.ics.uci.edu/~fielding/pubs/dissertation/top.htm
[2] Building Web Services the REST Way: http://www.xfront.com/REST-Web-Services.html
[3] Intoruction to mapping: http://www.infoq.com/articles/rest-introduction
[4]
</body>
</html>